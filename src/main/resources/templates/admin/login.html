<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Admin Login</title>
    <script src="../../static/js/adminLogin.js"></script>
</head>
<body>
    <header>

    </header>

    <main>
        <div class="formStyle">
                <input type="text" id="id" name="id" placeholder="아이디를 입력하세요." />
                <input type="password" id="password" name="password" placeholder="비밀번호를 입력하세요." />
                <input type="button" class="button" value="로그인" onclick="performLogin()" />
            <button class="sign-up-button">회원가입</button>
        </div>
    </main>

    <footer>

    </footer>
    <script>
        function performLogin() {
            const idAndPassword = { // RequestBody에 들어갈 Json의 이름, RestController 에서 받아쓸 수 있다.
                id: document.getElementById("id").value,
                password: document.getElementById("password").value
            };

            fetch("/api/admin/login", { // client > Server로 요청 보내기
                method: "POST", // POST 방식으로
                headers: {
                    "Content-Type": "application/json" // Json 타입으로 컨텐트를 보낼겁니다
                },
                body: JSON.stringify(idAndPassword) // data객체인 idAndPassword를 Json 형식으로 body에 첨부
            })
            .then(response => { // 요청을 보냈을때 응답이
                if (response.ok) { // response.ok : 통신 성공 여부 boolean 값
                    return response.json(); // 성공했을 시 응답에서 온 json 객체 리턴
                } else { // 응답에 실패했을 시
                    throw Error("Login Error"); // 에러 발생
                }
            })
            .then(data => { // 위에서 요청이 잘 왔을 경우에는
                window.location.href="/admin/loginSuccess"; // view단으로 GET 요청을 보내 서버 랜더링
            }).catch(error => {
                window.location.href="/admin/loginFail";
            });
        }
    </script>
</body>
</html>